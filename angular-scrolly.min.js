/*
 * angular-scrolly - v0.0.6 - 2013-10-06
 * http://github.com/ajoslin/angular-scrolly
 * Created by Andy Joslin; Licensed under Public Domain
 */
(function() {
!function(){angular.module("ajoslin.scrolly",["ajoslin.scrolly.scroller","ajoslin.scrolly.directives"]);var a=angular.element,b=angular.copy,c=angular.forEach,d=angular.isString,e=angular.extend;angular.module("ajoslin.scrolly.directives",["ajoslin.scrolly.scroller"]).directive("scrollyScroll",["$scroller","$document",function(b){return a(document.body).bind("touchmove",function(a){a.preventDefault()}),{restrict:"A",link:function(a,c){new b(c)}}}]),angular.module("ajoslin.scrolly.directives").directive("scrollyDraggerIgnore",[function(){return{restrict:"A",controller:angular.noop}}]),angular.module("ajoslin.scrolly.desktop",[]).provider("$desktopScroller",[function(){var b={38:150,40:-150,32:-600};this.key=function(a,c){return arguments.length>1&&(b[a]=c),b[a]};var c=.5;this.mouseWheelDistanceMulti=function(a){return arguments.length&&(c=a),c},this.$get=function(d){function e(c,g){function h(b){var d=b.wheelDeltaY*e.mouseWheelDistanceMulti;if(d)for(var f=a(b.target);f.length;){if(f[0]===c.parent()[0]){i(d),b.preventDefault();break}f=f.parent()}}function i(a){g.calculateHeight();var b=g.transformer.pos.y+a;g.transformer.setTo({x:0,y:f(-g.scrollHeight,b,0)})}function j(a){if(!(document.activeElement&&document.activeElement.tagName&&document.activeElement.tagName.match(l))){var c=b[a.keyCode||a.which];if(c){if(a.preventDefault(),g.transformer.changing)return;g.calculateHeight();var d=g.transformer.pos.y+c;if(d=f(-g.scrollHeight,d,0),d!==g.transformer.pos.y){var h=d-g.transformer.pos.y,i=Math.abs(h*e.easeTimeMulti);g.transformer.easeTo({x:0,y:d},i)}}}}var k={};c.bind("$destroy",function(){d.unbind("mousewheel",h),d.unbind("keydown",j)}),d.bind("mousewheel",h),d.bind("keydown",j);var l=/INPUT|TEXTAREA|SELECT/i;return k}function f(a,b,c){return Math.min(Math.max(a,b),c)}return e.mouseWheelDistanceMulti=c,e.easeTimeMulti=.66,e}}]),angular.module("ajoslin.scrolly.dragger",[]).provider("$dragger",[function(){var d=!0;this.shouldBlurOnDrag=function(a){return arguments.length&&(d=!!a),d};var f=40;this.allowedDragAngle=function(a){return arguments.length&&(f=a),f};var g=300;this.maxTimeMotionless=function(a){return arguments.length&&(g=a),g},this.$get=["$window","$document",function(){function h(h,l){function m(b){b=b.originalEvent||b;var c=a(b.target||b.srcElement);if(!c.controller("scrollyDraggerIgnore")){b.stopPropagation();var e=b.touches?b.touches[0]:b;d&&u(c)&&document.activeElement&&document.activeElement.blur(),v.state=r({x:e.pageX,y:e.pageY}),p("start",!0)}}function n(a){if(a=a.originalEvent||a,v.state.active){a.preventDefault(),a.stopPropagation();var b=a.touches?a.touches[0]:a;b={x:b.pageX,y:b.pageY};var c=Date.now()-v.state.updatedAt;c>g&&(v.state=r(b)),s(v.state,b);var d=q(b,v.state.origin)%180;v.state.direction=90+f>d&&d>90-f?i:f>d&&d>-f?j:k,p("move")}}function o(a){v.state.active&&(a=a.originalEvent||a,a.stopPropagation(),v.state.updatedAt=Date.now(),v.state.stopped=v.state.updatedAt-v.state.startedAt>g,p("end",!0),v.state={})}function p(a,d){var e=b(v.state);c(w,function(b,f){(d||!e.direction||e.direction==f||f==k)&&c(b,function(b){b(a,e)})})}function q(a,b){var c=Math.atan2(-(b.y-a.y),b.x-a.x);0>c&&(c+=2*Math.PI);var d=Math.floor(c*(180/Math.PI)-180);return 0>d&&d>-180&&(d=360-Math.abs(d)),Math.abs(d)}function r(a){return{origin:{x:a.x,y:a.y},pos:{x:a.x,y:a.y},distance:{x:0,y:0,magnitude:0},delta:{x:0,y:0,magnitude:0},startedAt:Date.now(),updatedAt:Date.now(),stopped:!1,active:!0}}function s(a,b){a.delta=t(b,a.pos),a.distance=t(b,a.origin),a.pos={x:b.x,y:b.y},a.updatedAt=Date.now()}function t(a,b){var c={x:a.x-b.x,y:a.y-b.y};return c.magnitude=Math.sqrt(c.x*c.x+c.y*c.y),c}function u(a){return a&&("INPUT"===a.tagName||"SELECT"===a.tagName||"TEXTAREA"===a.tagName)}l=e({mouse:!0,touch:!0},l);var v={};h[0];var w={};w[i]=[],w[j]=[],w[k]=[];var x=h.data("$scrolly.dragger");return x?x:(h.data("$scrolly.dragger",v),v.state={},v.addListener=function(a,b){1===arguments.length&&(b=a,a=k),w[a].push(b||angular.noop)},v.removeListener=function(a,b){1===arguments.length&&(b=a,a=k);var c=w[a].indexOf(b);c>-1&&w[a].splice(c,1)},l.touch&&(h.bind("touchstart",m),h.bind("touchmove",n),h.bind("touchend touchcancel",o)),l.mouse&&(h.bind("mousedown",m),h.bind("mousemove",n),h.bind("mouseup mouseout",o)),h.bind("$destroy",function(){delete w[DIRECTION_VERITCAL],delete w[j],delete w[k]}),v)}var i=h.DIRECTION_VERTICAL=1,j=h.DIRECTION_HORIZONTAL=2,k=h.DIRECTION_ANY=3;return h}]}]),angular.module("ajoslin.scrolly.scroller",["ajoslin.scrolly.dragger","ajoslin.scrolly.transformer","ajoslin.scrolly.desktop"]).provider("$scroller",[function(){function a(a){return 0|a}var b=.001;this.decelerationRate=function(a){return arguments.length&&(b=a),b};var c=!0;this.supportDesktop=function(a){return c=!!a};var d=.5;this.pastBoundaryScrollRate=function(a){return arguments.length&&(d=a),d};var e=10;this.minDistanceForAcceleration=function(a){return arguments.length&&(e=a),e};var f=40;this.bounceBuffer=function(a){return arguments.length&&(f=a),f};var g=200,h=1.5;this.bounceBackMinTime=function(a){return arguments.length&&(g=a),g},this.bounceBackDistanceMulti=function(a){return arguments.length&&(h=a),h},this.$get=["$dragger","$transformer","$window","$document","$desktopScroller",function(d,i,j,k,l){function m(a){return Math.abs(a)*h+g}function n(g){function h(b,c){switch(b){case"start":q.changing&&q.stop(),k.calculateHeight();break;case"move":var d=q.pos.y+c.delta.y;k.outOfBounds(d)&&(d=q.pos.y+a(.5*c.delta.y)),q.setTo({x:0,y:d});break;case"end":if(k.outOfBounds(q.pos.y)||c.stopped)k.checkBoundaries();else if(Math.abs(c.distance.y)>=e){var f=k.momentum(c);f.position!==q.pos.y&&q.easeTo({x:0,y:f.position},f.time,k.checkBoundaries)}}}var k={},o=g.data("$scrolly.scroller");if(o)return o;g.data("$scrolly.scroller",k);var p=g[0],q=k.transformer=new i(g),r=k.dragger=new d(g,{touch:!0,mouse:!1});return c&&new l(g,k),r.addListener(d.DIRECTION_VERTICAL,h),g.bind("$destroy",function(){r.removeListener(d.DIRECTION_VERTICAL,h)}),k.calculateHeight=function(){var a=n.getContentRect(p),b=j.innerHeight;return k.scrollHeight=a.height<b?0:a.height-b+a.top+a.bottom,k.scrollHeight},k.calculateHeight(),k.outOfBounds=function(a){return a>0?a:a<-k.scrollHeight?a+k.scrollHeight:!1},k.checkBoundaries=function(){k.calculateHeight();var a=k.outOfBounds(q.pos.y);if(a){var b=a>0?0:-k.scrollHeight;q.easeTo({x:0,y:b},m(a))}},k.momentum=function(c){k.calculateHeight();var d,e=Math.abs(c.distance.y)/(c.updatedAt-c.startedAt),g=q.pos.y+e*e/(2*b)*(c.distance.y<0?-1:1),h=e/b,i=k.outOfBounds(g);return i&&(i>0?g=Math.min(i,f):0>i&&(g=Math.max(g,-(k.scrollHeight+f))),d=Math.abs(g-q.pos.y),h=d/e),{position:g,time:a(h)}},k}return n.getContentRect=function(a){var b=window.getComputedStyle(a),c=parseInt(b.getPropertyValue("margin-top"),10)+parseInt(b.getPropertyValue("padding-top"),10),d=parseInt(b.getPropertyValue("margin-bottom"),10)+parseInt(b.getPropertyValue("padding-bottom"),10),e=parseInt(b.getPropertyValue("top"),10),f=parseInt(b.getPropertyValue("bottom"),10),g=parseInt(b.getPropertyValue("height"),10);return{top:c+(isNaN(e)?0:e),bottom:d+(isNaN(f)?0:f),height:g}},n}]}]),angular.module("ajoslin.scrolly.transformer",[]).factory("$nextFrame",["$window",function(a){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||function(b){return a.setTimeout(b,17)}}]).provider("$transformer",[function(){var a="cubic-bezier(0.25, 0.46, 0.45, 0.94)";this.timingFunction=function(b){return arguments.length&&(a=b),a},this.$get=["$window","$nextFrame","$sniffer","$document",function(b,c,e,f){function g(b){return l+" "+b+"ms "+a}function h(a,b){return"translate3d("+(a||0)+"px,"+(b||0)+"px,0)"}function i(a){var d={},e=a[0],f=a.data("$scrolly.transformer");if(f)return f;a.data("$scrolly.transformer",d),d.pos={x:0,y:0},d.updatePosition=function(){var a=b.getComputedStyle(e),c=(a[k]||"").replace(/[^0-9-.,]/g,"").split(",");return c.length>1&&(d.pos.x=parseInt(c[4],10),d.pos.y=parseInt(c[5],10)),d.pos},d.updatePosition();var i;return d.stop=function(a){i&&(b.clearTimeout(i),i=null),e.style[m]="none",d.updatePosition(),d.changing=!1,c(function(){d.setTo(d.pos),(a||angular.noop)()})},d.easeTo=function(a,f,h){function j(){e.style[m]=g(f),d.changing=!0,c(function(){d.setTo(a),i=b.setTimeout(function(){d.stop(),(h||angular.noop)()},f)})}if(!angular.isNumber(f)||0>f)throw new Error("Expected a positive number for time, got '"+f+"'.");d.changing?d.stop(j):j()},d.setTo=function(a){d.pos.x=a.x,d.pos.y=a.y,e.style[k]=h(d.pos.x,d.pos.y)},d}e.vendorPrefix||d(f[0].body.style.webkitTransition)&&(e.vendorPrefix="webkit");var j=e.vendorPrefix;j&&"Moz"!==j&&"O"!==j&&(j=j.substring(0,1).toLowerCase()+j.substring(1));var k=j?j+"Transform":"transform",l=j?"-"+j.toLowerCase()+"-transform":"transform",m=j?j+"Transition":"transition";return i.transformProp=k,i.transformPropDash=l,i.transitionProp=m,i}]}])}();
}());